<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Posts | 馬丁沒有派對</title>
<meta name="keywords" content="">
<meta name="description" content="Posts - 馬丁沒有派對">
<meta name="author" content="">
<link rel="canonical" href="https://blog.ooopiz.com/post/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.bccfefac377bc340f06c260aed1bddf49a4354816d7c570d6aac75a997986c95.css" integrity="sha256-vM/vrDd7w0DwbCYK7Rvd9JpDVIFtfFcNaqx1qZeYbJU=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://blog.ooopiz.com/logo/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://blog.ooopiz.com/logo/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://blog.ooopiz.com/logo/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://blog.ooopiz.com/logo/apple-touch-icon.png">
<link rel="mask-icon" href="https://blog.ooopiz.com/logo/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="https://blog.ooopiz.com/post/index.xml">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3680083267042451" crossorigin="anonymous"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4XSTL9TGTE"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-4XSTL9TGTE', { 'anonymize_ip': false });
}
</script>
<meta property="og:title" content="Posts" />
<meta property="og:description" content="我把青春都寫在blog上了 😜😜" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://blog.ooopiz.com/post/" /><meta property="og:image" content="https://blog.ooopiz.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"/><meta property="og:site_name" content="馬丁沒有派對" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://blog.ooopiz.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"/>

<meta name="twitter:title" content="Posts"/>
<meta name="twitter:description" content="我把青春都寫在blog上了 😜😜"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://blog.ooopiz.com/post/"
    }
  ]
}
</script>
</head>

<body class="list dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://blog.ooopiz.com/" accesskey="h" title="馬丁沒有派對 (Alt + H)">
                <img src="https://blog.ooopiz.com/logo/apple-touch-icon.png" alt="" aria-label="logo"
                    height="35">馬丁沒有派對</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://blog.ooopiz.com/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://blog.ooopiz.com/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="https://blog.ooopiz.com/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://blog.ooopiz.com/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://blog.ooopiz.com/links/" title="Links">
                    <span>Links</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header"><div class="breadcrumbs"><a href="https://blog.ooopiz.com/">Home</a></div>
  <h1>
    Posts
    <a href="index.xml" title="RSS" aria-label="RSS">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
        stroke-linecap="round" stroke-linejoin="round" height="23">
        <path d="M4 11a9 9 0 0 1 9 9" />
        <path d="M4 4a16 16 0 0 1 16 16" />
        <circle cx="5" cy="19" r="1" />
      </svg>
    </a>
  </h1>
</header>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>IPsec Lan to Lan Vigor-2925 and AWS-ec2
    </h2>
  </header>
  <div class="entry-content">
    <p>前言 簡單說一下就是，我想讓我所在的網路可以訪問到 AWS subnet 的固定子網 IP，
內網的工作同仁或者內部 Server 不用額外做 vpn 撥號或其他動作。
其實 AWS 上面也有現成的服務可以租用（在 VPC 的設定中）
一個月大概在台幣 1,000 左右 AWS VPN pricing。
但基於我想自己架看看，另外也可以省點錢，就租了一台 EC2 來土炮了。
目標就是使用 Vigor 2925 播出到 IPsec server 保持一個 Lan to Lan 的連線。
公司端：
設備：Vigor 2925 網段：192.168.0.0/24 AWS 端：
網段：172.21.0.0/16 IPsec Server ： CentOS7, EIP libreSwan 簡介 libreSwan 是 IPsec 協議的開源實現，基於FreeSwan 專案。
在 Centos7 版本後， 提供ipsec 服務包由libreswan替代了openswan
安裝 libreswan $ yum install epel-release $ yum install libreswan 設定 ipsec ipsec 啟動時會載入 /etc/ipsec....</p>
  </div>
  <footer class="entry-footer"><span title='2019-05-17 08:02:00 +0800 CST'>May 17, 2019</span></footer>
  <a class="entry-link" aria-label="post link to IPsec Lan to Lan Vigor-2925 and AWS-ec2" href="https://blog.ooopiz.com/post/2019/05/vigor2925-ipsec-lantolan-aws-ec2/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>關於 Docker volume create
    </h2>
  </header>
  <div class="entry-content">
    <p>前言 某次我在看某個服務的安裝文件時，發現了 docker volume create 這個指令。
原本我都是使用 -v 對應到我 host 機器的目錄
ex :
-v $(pwd)/nginx-cache:/var/cache/nginx
後來很好奇 docker volume create 的用途還有存放路徑。
於是就小小的研究了一下。
docker volume create 一般的 Linux 在執行 docker volume create … 之後，
可以在 /var/lib/docker/volumes 看到 docker 幫你建立 volume 名稱的資料夾。
docker volume create In Mac 可是當你使用 Mac 執行過 docker volume create … 之後，
並無法在 Mac 電腦中找到 /var/lib/docker/volumes 這個目錄。
在 Mac 電腦 是無法直接訪問 /var/lib/docker/volumes 這個目錄，
必須先 screen 到 docker 目錄下的 tty，
進到 tty 之後就可以在 /var/lib/docker/volums 看到 create 的目錄名稱了。...</p>
  </div>
  <footer class="entry-footer"><span title='2019-05-10 07:22:01 +0800 CST'>May 10, 2019</span></footer>
  <a class="entry-link" aria-label="post link to 關於 Docker volume create" href="https://blog.ooopiz.com/post/2019/05/docker-volume-create/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Gitlab-ce 版本升級與容器化
    </h2>
  </header>
  <div class="entry-content">
    <p>升級目標 gitlab-ce:8.14.4 升級到 gitlab-ce:11.3.4 Omnibus 轉移到 Docker 容器（Dockerized） 步驟流程 一、備份 Omnibus 上的資料 二、準備 docker 環境 三、啟動新環境（使用 gitlab-ce:8.14.4-ce.0 版本的 Image）與還原 四、版本逐步升級 一、備份 Omnibus 上的資料 $ gitlab-rake gitlab:backup:create
二、準備 docker 環境 Install docker, docker-compose 檔案存放的根目錄我設定在 /srv/gitlab，因此先在母體主機建立三個資料夾後續給 docker 掛載。 /srv/gitlab/config /srv/gitlab/logs /srv/gitlab/data 三、啟動新環境（使用 gitlab-ce:8.14.4-ce.0 版本的 Image）與匯入 複製 omnibus 機器下的主機金鑰組到新環境 From omnibus (/etc/ssh/ssh_host_*) copy to /srv/gitlab/config/ 撰寫 docker-compose.yaml 如下 hostname 與 external_url 替換成自己的參數 web: image: &#39;gitlab/gitlab-ce:8.14.4-ce.0&#39; container_name: gitlab restart: always hostname: &#39;git.example.com&#39; environment: TZ: Asia/Taipei GITLAB_OMNIBUS_CONFIG: | external_url &#39;http://git....</p>
  </div>
  <footer class="entry-footer"><span title='2018-11-01 10:45:51 +0800 CST'>November 1, 2018</span></footer>
  <a class="entry-link" aria-label="post link to Gitlab-ce 版本升級與容器化" href="https://blog.ooopiz.com/post/2018/11/gitlab-version-update-and-dockerized/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>opensourcepos 安裝
    </h2>
  </header>
  <div class="entry-content">
    <p>php pos 商用版
開源版本 opensourcepos
OpenSource POS其實就是舊版本的源碼釋出，基本上版本落差有點大，合不合用就只能試試才知道了
環境準備： 安裝lamp
php require
php-gd php-bcmath php-intl php-sockets php-mcrypt php-curl installed and enabled. 下載程式： # cd /var/www # git clone https://github.com/jekkos/opensourcepos.git
# mv opensourcepos pos # cd /var/www/pos
看你要使用哪個版本 使用git指令切過去 # git checkout tags/3.0.2 -b b_3.0.2
設置權限： # chown -R apache:apache /var/www/pos
匯入資料：(db資訊依照自己的資訊填入) # mysql pos /var/www/pos/database/database.sql
設定檔： # cd /var/www/pos/application/config # cp database.php.tmpl database.php
# vi database.php
$db[&#39;default&#39;][&#39;hostname&#39;] = &#39;localhost&#39;; $db[&#39;default&#39;][&#39;username&#39;] = &#39;db_user&#39;; $db[&#39;default&#39;][&#39;password&#39;] = &#39;db_pass&#39;; $db[&#39;default&#39;][&#39;database&#39;] = &#39;pos&#39;; apache設定 vi /etc/httpd/conf....</p>
  </div>
  <footer class="entry-footer"><span title='2017-05-15 07:46:01 +0800 CST'>May 15, 2017</span></footer>
  <a class="entry-link" aria-label="post link to opensourcepos 安裝" href="https://blog.ooopiz.com/post/2017/05/opensourcepos-install/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>pem轉ppk putty 登入
    </h2>
  </header>
  <div class="entry-content">
    <p>putty不支援openssh, 所以手上有pem檔的話需要做一次轉換 前往下載 puttygen.exe
pem 轉 ppk 1.載入pem 2.如果看不到檔案請選all file 3.載入後選擇save private key 4.輸入檔名生成ppk檔 putty設定登入 1.轉換完成的ppk檔放置到你想保存的位置 2.開啟putty (以下為範例照自己的機器與檔案資訊填寫) 3.輸入用戶名稱 4.載入ppk檔 5.記得回來按一下存檔 linux or Cmder登入方式 ssh -i xxx.pem username@192.168.1.1
改port的話
ssh -i pem路徑 用戶名稱@主機位址 -p Port端口</p>
  </div>
  <footer class="entry-footer"><span title='2017-03-21 02:21:01 +0800 CST'>March 21, 2017</span></footer>
  <a class="entry-link" aria-label="post link to pem轉ppk putty 登入" href="https://blog.ooopiz.com/post/2017/03/pem-to-ppk-putty-login/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>php call java 類別
    </h2>
  </header>
  <div class="entry-content">
    <p>php-java-bridge 介紹
php-java-bridge 載點
Files &gt; Binary package &gt; JavaBridgeTemplate621.war
我下載到的版本是JavaBridgeTemplate621.war
寫一個jar來做測試 # mkdir TestMath
# cd TestMath
# vi TestMath.java
public class TestMath { private Integer num1; private Integer num2; public TestMath() { this.num1 = 0; this.num2 = 0; } public TestMath(Integer n1, Integer n2) { this.num1 = n1; this.num2 = n2; } public void setNum1(Integer n) { this.num1 = n; } public void setNum2(Integer n) { this.num2 = n; } public Integer plus() { return num1 &#43; num2; } public Integer minus() { return num1 - num2; } } # javac TestMath....</p>
  </div>
  <footer class="entry-footer"><span title='2016-12-21 03:23:01 +0800 CST'>December 21, 2016</span></footer>
  <a class="entry-link" aria-label="post link to php call java 類別" href="https://blog.ooopiz.com/post/2016/12/php-call-java-class/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>GitLab 7.14升級8.X
    </h2>
  </header>
  <div class="entry-content">
    <p>簡介 上次安裝Gitlab大約將近一年前了，Gitlab也更新了很多功能，因此來著手進行一次升級，順便練習一下 recovery，以免意外發生時手忙腳亂．
目前版本：gitlab-ce-7.14.3-ce.1.el7.x86_64 預計更新版本：就更新到最新版吧目前是8.14.4
一開始傻傻的，想要把舊版本的backup檔，直接到8.X版本進行匯入， 很快的它就會告訴你版本不合了， 只好再用別的方式
後來我準備了兩台伺服器， 一台先安裝7.14.3 一台安裝最新版8.14.4
預計先將7.14.3的備份檔匯入第一台伺服器，之後進行升級， 然後因為個人有點龜毛，再用升級好機器備份出8.14.4版的備份檔， 來到全新的新版機器(8.14.4)再進行匯入
流程 舊機器 7.14.3 備份 1. 備份backup檔 在原本的機器上下指令備份gitlab資料
# gitlab-rake gitlab:backup:create
新機器版本 7.14.3 這台機器要先裝好 7.14.3，匯入備份檔，再用 yum 更新到 8.14.4。
1.安裝 我自己都用Omnibus 所以就先把Omnibus(gitlab-ce-7.14.3-ce.1.el7.x86_64)裝起來吧
gitlab 官網有美美的教學，自己來吧
其中有遇到一個問題是gitlab-ctl reconfigure時會停在[supervise_redis_sleep]
# sudo /opt/gitlab/embedded/bin/runsvdir-start &amp;
# sudo gitlab-ctl reconfigure
Ref:
Freeze on ruby_block[supervise_redis_sleep] action run 2. 匯入backup檔 我將backup檔copy到新伺服器的備份目錄下，執行recovery時，程序會自動將檔案recovery回去
mv to /var/opt/gitlab/backups/
3.開始前先停止相關數據服務連線 # gitlab-ctl stop unicorn
# gitlab-ctl stop sidekiq
4.從1393513186編號備份中復原(看你的檔案編號是啥鬼) # gitlab-rake gitlab:backup:restore BACKUP=1393513186...</p>
  </div>
  <footer class="entry-footer"><span title='2016-12-08 13:22:01 +0800 CST'>December 8, 2016</span></footer>
  <a class="entry-link" aria-label="post link to GitLab 7.14升級8.X" href="https://blog.ooopiz.com/post/2016/12/gitlab-upgrade-7.14-to-8/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="prev" href="https://blog.ooopiz.com/post/page/2/">
      «&nbsp;Prev&nbsp;
    </a>
    <a class="next" href="https://blog.ooopiz.com/post/page/4/">Next&nbsp;&nbsp;»
    </a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://blog.ooopiz.com/">馬丁沒有派對</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
